const contentNode=document.getElementsByClassName("content")[0],inputNode=document.getElementsByTagName("input")[0],promptNode=document.getElementById("prompt");inputNode.addEventListener("keyup",function(e){"Enter"!==e.key&&"Go"!==e.key||handleEnter()});let pwd="~";const folders={"index.html":"file","projects.html":"file","about.html":"file",example:{hello:"file",world:"file",foo:{},bar:{}},"impressum.html":"file","datenschutz.html":"file"};let currentFolder=folders,zoom=0;function handleEnter(){const e=inputNode.value,t=e.split(" "),n=t[0].trim(),o=t[1];if(inputNode.value="",appendLine(getPrompt()+e),matrixRunning&&(console.log("stopmatrix"),stopMatrix(),"zoomout"===n&&zoom<2))return zoom++,void matrix();switch(zoom=0,n){case"":break;case"clear":clearContent();break;case"ls":showFiles();break;case"cd":changeDirectory(o);break;case"help":showHelp();break;case"open":openFile(o);break;case"matrix":matrix();break;default:appendLine("unknown command: "+n)}promptNode.scrollIntoView()}function getPrompt(){return style("guest@robindanzinger.de:"+pwd+"$ ","brown bold")}function clearContent(){contentNode.innerHTML=""}function showFiles(){for(let e in currentFolder)"file"===currentFolder[e]?appendStyledLine(e,"bold"):appendStyledLine(e,"lightblue bold")}function appendLine(e){contentNode.innerHTML+=e+"<br>"}function appendStyledLine(e,t){contentNode.innerHTML+=style(e,t)+"<br>"}function showTable(e){let t="<table class='simpleborder'>";return e.forEach(e=>{t+="<tr>",e.forEach(e=>{t+="<td>"+e+"</td>"}),t+="</tr>"}),t+="</table>"}function style(e,t){return'<span class="'+t+'">'+e+"</span>"}function changeDirectory(e="~"){switch(e){case"..":changeToFolder(e);break;case".":break;case"~":case"":case" ":changeToFolder("~");break;default:exist(e)&&"_files"!==e?changeToFolder(e):appendLine("Directory does not exist")}}function exist(e){return null!=getFolder(pwd+"/"+e)}function getFolder(e){const t=e.split("/");let n=folders;for(let e of t)if("~"==e)n=folders;else if(!(n=n[e])||"file"===n)return;return n}function changeToFolder(e){".."==e?pwd.lastIndexOf("/")>0&&(pwd=pwd.substring(0,pwd.lastIndexOf("/"))):"~"==e?pwd="~":pwd+="/"+e,promptNode.innerHTML=getPrompt(),currentFolder=getFolder(pwd)}function openFile(e){"file"===currentFolder[e]?window.location=e:appendLine("File not found:"+e)}function showHelp(){["Help","Version1.0",""].forEach(appendLine),appendLine(showTable([[style("help:","helpkeyword"),"Zeigt diese Hilfe an"],[style("clear:","helpkeyword"),"Löscht den Inhalt des Terminals"],[style("ls:","helpkeyword"),"Listet den Inhalt des aktuellen Verzeichnisses auf"],[style("cd [directory]:","helpkeyword"),"Wechselt in das Verzeichnis [directory]"],[style("| [dir] = '..':","nowrap helpkeyword tab"),"Wechselt in das Elternverzeichnis"],[style("| [dir] = '.':","nowrap helpkeyword tab"),"Wechselt in das aktuelle Verzeichnis"],[style("open [file]:","helpkeyword"),"Öffnet die angegebene Datei"],[style("cat [file]:","helpkeyword"),"Zeigt den Inhalt der Datei im Terminal an"],[style("matrix:","helpkeyword"),"Zeigt die Matrix an"]]))}let matrixRunning=!1;function matrix(){matrixRunning=!0,clearContent(),contentNode.style.height="calc(100vh - 5.6rem)",contentNode.innerHTML="<canvas id='canvas' class='matrix' width='"+contentNode.offsetWidth+"' height='"+(contentNode.offsetHeight-20)+"'></canvas>";const e=document.getElementById("canvas"),t=e.getContext("2d");let n=.99,o=1;1==zoom?o=.9:2==zoom&&(o=.5);const r=parseInt(getComputedStyle(document.documentElement).fontSize),l=r*o,i=r*o,a=e.width,s=e.height,d=Math.round(a/l),c=Math.round(s/i)+2,p="安吧八爸百北不岛的弟地东都对多二哥个关贵国过好很会见叫姐京九李零六妈么没美妹们名明那南你您起千去认日上谁什生师十识是四她台天万王我五息系先香想小谢姓休学一亿英友月张这中字0123456789".split(""),h=new Array;!function(){for(let e=0;e<d;e++){h.push([]);for(let t=0;t<c;t++){const t=p[Math.floor(Math.random()*p.length)];h[e].push(t)}}}();const f=new Array(d);for(let e=0;e<f.length;e++)f[e]=[];let u=0;function m(e,t){return 0==e?"oldlace":"hsl(120, 100%, "+Math.floor(60-e/t*60)+"%)"}!function e(){if(t.globalCompositeOperation="source-over",t.font=o+"rem monospace",Date.now()-u<50)requestAnimationFrame(e);else{t.clearRect(0,0,a,s),matrixRunning&&requestAnimationFrame(e),function(){for(let e=0;e<d;e++){h.push([]);for(let t=0;t<c;t++)Math.random()>.95&&(h[e][t]=p[Math.floor(Math.random()*p.length)])}}();for(let e=0;e<d;e++)Math.random()>n&&f[e].push((r=c,{position:0,length:Math.floor(1.5*Math.random()*r)+5,speed:Math.floor(7*Math.random())/7+.4})),f[e].forEach(n=>{const o=e*l;for(let r=0;r<n.length;r++){const l=Math.floor(n.position),a=l-r;if(a>=0&&a<c){t.fillStyle=m(r,n.length);const s=(l-r)*i;t.fillText(h[e][a],o,s)}}n.position+=n.speed,n.position>c+n.length&&f[e].unshift()});var r;1==zoom&&(t.globalCompositeOperation="destination-in",t.beginPath(),t.lineWidth=400,t.moveTo(-100,s/2+10),t.bezierCurveTo(a/4,s/10,3*a/4,s/9,a+100,2*s),t.stroke()),2==zoom&&(t.globalCompositeOperation="destination-in",t.font=.7*a+"px monospace",t.fillText("42",a/10,s)),u=Date.now()}}()}function stopMatrix(){matrixRunning=!1;const e=document.getElementById("canvas");e.parentNode.removeChild(e),contentNode.style.height="auto"}